
\comment{
\begin{definition}
\label{def:grouping}
\textbf{(Grouping effect)}. 
Given a set of objects $\mathcal{X} = \{x_1, x_2,..., x_n\}$,
let $\bmw_q$ be the $q$-th column of $\mathcal{W}$. 
Further, let $\xarrow{i}{j}$ denote the condition:
(1) $\bmx_i^T \bmx_j \rightarrow 1$ and 
(2) $\lVert \bmw_i - \bmw_j \rVert_2 \rightarrow 0$.
A Matrix $Z$ is said to have grouping effect
if
\[
\xarrow{i}{j} \Rightarrow |Z_{ip} - Z_{jp}| \rightarrow 0\; \forall 1 \leq p \leq n.
\]
\end{definition}
}

This technical report proves the grouping effect of $|Z^*|$,$|(Z^*)^T|$ and $\tilde{Z}$.
In the following discussion, we use $\bmz_q^*$ to denote the $q$-th column vector of $Z^*$.

\begin{lemma}
\label{lemma1}
Given a set of objects $\mathcal{X}$,
the matrix
$X\in \mathcal{R}^{p\times n}$ that is composed of the {\pev}s as rows,
 the reachability matrix $\mathcal{W}$,
 and the optimal soution $Z^*$,
\begin{equation}
\label{eq:zi}
Z_{ip}^* = \frac{\bm{x}_i^T(\bm{x}_p-X\bm{z}_p^*) + \alpha_2 \mathcal{W}_{ip}}{\alpha_1+\alpha_2}, \;\;\; \forall 1 \leq i, p \leq n.
\end{equation}
\end{lemma}

\begin{proof}
For $1 \leq p \leq n$,
let $J(\bm{z}_p) =  ||\bm{x}_p-X\bm{z}_p||_2^2 + \alpha_1 ||\bm{z}_p||_2^2 + \alpha_2 ||\bm{z}_p-\bm{w}_p||_2^2$.
Since $Z^*$ is the optimal solution, we have $\frac{\partial{J}}{\partial{Z}_{ip}}|_{\bm{z}_p = \bm{z}_p^*} = 0\; \forall 1\leq i \leq n$.
Hence, $-2\bm{x}_i^T(\bm{x}_p-X\bm{z}_p^*)+2\alpha_1Z_{ip}^*+2\alpha_2(Z_{ip}^*-\mathcal{W}_{ip}) = 0$,
which induces Equation~\ref{eq:zi}.
\end{proof}

\begin{lemma}
\label{lemma2}
%Given a set of objects $X\in R^{d\times n}$ and a TKNN graph $\mathcal{G} = (\mathcal{V}, \mathcal{E}, \mathcal{W}_K)$,
%let $\bm{x}_p$ be an arbitrary object, 
%$\bm{w}_p$ be the column vector in $\mathcal{W}_K$ describing the connectivity of $\bm{x}_p$, and
%$\bm{z}_p^*$ be the optimal solution to the problem 
%$\min_{\bm{z}_p} ||\bm{x}_p-X\bm{z}_p||_2^2 + \lambda_1 ||\bm{z}_p||_2^2 + \lambda_2 ||\bm{z}_p-\bm{w}_p||_2^2$.
%Assume all the objects have been normalized.
%For any two objects $\bm{x}_i$ and $\bm{x}_j$,
$\forall 1 \leq i, j, p \leq n$,
\begin{equation}
\label{eq:norm}
|Z_{ip}^*-Z_{jp}^*| \leq \frac{c\sqrt{2(1-r)} + \alpha_2|\mathcal{W}_{ip}-\mathcal{W}_{jp}|}{\alpha_1+\alpha_2},
\end{equation}
where $c = \sqrt{1+\alpha_2||\bm{w}_p||_2^2}$ and $r = \bm{x}_i^T\bm{x}_j$.
\end{lemma}

\begin{proof}
From Equation~\ref{eq:zi}, we have 
\begin{equation}
\nonumber
Z_{ip}^*-Z_{jp}^* = \frac{(\bm{x}_i^T - \bm{x}_j^T)(\bm{x}_p-X\bm{z}_p^*) + \alpha_2 (\mathcal{W}_{ip}-\mathcal{W}_{jp})}{\alpha_1+\alpha_2}.
\end{equation}
That implies 
\begin{small}
\begin{equation}
\label{eq:zizj}
\begin{split}
|Z_{ip}^*-Z_{jp}^*| & \leq \frac{|(\bm{x}_i^T - \bm{x}_j^T)(\bm{x}_p-X\bm{z}_p^*)| + \alpha_2 |(\mathcal{W}_{ip}-\mathcal{W}_{jp})|}{\alpha_1+\alpha_2}\\
& \leq \frac{||(\bm{x}_i^T - \bm{x}_j^T)||_2||(\bm{x}_p-X\bm{z}_p^*)||_2 + \alpha_2 |(\mathcal{W}_{ip}-\mathcal{W}_{jp})|}{\alpha_1+\alpha_2}\\
\end{split}
\end{equation}
\end{small}

Since the column vectors of $X$ are normalized (i.e., $\bmx_q^T \bmx_q = 1 \; \forall 1 \leq q \leq n$) , we have
$||(\bm{x}_i^T - \bm{x}_j^T)||_2 = \sqrt{2(1-r)}$,
where $r = \bm{x}_i^T\bm{x}_j$.
%measuring the closeness between $\bm{x}_i$ and $\bm{x}_j$ in the feature space.
%As $\bm{z}_p^*$ is the optimal solution, 
As $Z^*$ is the optimal solution, we have
\begin{equation}
\begin{split}
J(\bm{z}_p^*) & = ||\bm{x}_p-X\bm{z}_p^*||_2^2 + \alpha_1 ||\bm{z}_p^*||_2^2 + \alpha_2 ||\bm{z}_p^*-\bm{w}_p||_2^2 \leq  \\
J(\bm{0}) & = ||\bm{x}_p||_2^2 + \alpha_2 ||\bm{w}_p||_2^2 = 1 + \alpha_2 ||\bm{w}_p||_2^2.
\end{split}
\end{equation}
Hence, $||\bm{x}_p-X\bm{z}_p^*||_2 \leq \sqrt{1 + \alpha_2 ||\bm{w}_p||_2^2} = c$.
Equation~\ref{eq:zizj} can be further simplified as
\begin{equation}
\nonumber
|Z_{ip}^*-Z_{jp}^*| \leq \frac{c\sqrt{2(1-r)}+ \alpha_2 |(\mathcal{W}_{ip}-\mathcal{W}_{jp})|}{\alpha_1+\alpha_2}.
\end{equation}
\end{proof}

\begin{lemma}
$Z^*$ and $|Z^*|$ have grouping effect.
\label{lemma:z-star}
\end{lemma}
\begin{proof}
Given two objects $x_i$ and $x_j$ such that $\xarrow{i}{j}$,
we have,  %by definition, 
(1) $\bmx_i^T \bmx_j \rightarrow 1$ and (2) $||\bmw_{i}-\bmw_{j}||_2 \rightarrow 0$.
These imply
$r = \bmx_i^T \bmx_j \rightarrow 1$ and  $|\mathcal{W}_{ip}-\mathcal{W}_{jp}| \rightarrow 0$.
Hence, the two terms of the numerator of the R.H.S of Equation~\ref{eq:norm} are close to 0. 
Therefore, $|Z_{ip}^*-Z_{jp}^*| \rightarrow 0$ and thus $Z^*$ has grouping effect.
Further,
we have 
$\bigl||Z_{ip}^*|-|Z_{jp}^*|\bigr| \leq |Z_{ip}^*-Z_{jp}^*|$,
so $\bigl||Z_{ip}^*|-|Z_{jp}^*|\bigr| \rightarrow 0$ and $|Z^*|$ has grouping effect.
\end{proof}

\begin{lemma}
\label{lemma3}
$(Z^*)^T$ and $|(Z^*)^T|$ have grouping effect. 
\begin{proof}
The problem is equivalent to if $x_i \rightarrow x_j$, $Z^*_{pi} \rightarrow Z^*_{pj}$.
From Lemma~\ref{lemma1},
\begin{equation}
\nonumber
z_{pi}^*-z_{pj}^* = \frac{\bm{x}_p^T ( \bmx_i - \bmx_j - X(\bm{z}_i^*-\bm{z}_j^*)) + \alpha_2 (W_{pi}-W_{pj})}{\alpha_1+\alpha_2}.
\end{equation}
Since $\bm{z}_i^* = (X^TX + \alpha_1I + \alpha_2I)^{-1}(X^T\bmx_i+\alpha_2\bm{w}_i),\bm{z}_j^* = (X^TX + \alpha_1I + \alpha_2I)^{-1}(X^T\bmx_j+\alpha_2\bm{w}_j)$,
let $Y = X(X^TX + \alpha_1I + \alpha_2I)^{-1}$. Then
\begin{equation}
\begin{split}
|Z_{pi}^*-Z_{pj}^*| & \leq \frac{||\bmx_p^T(\bm{x}_i - \bm{x}_j)||_2 + ||\bmx_p^TX(\bm{z}_i^*-\bm{z}_j^*)||_2 + \alpha_2 |(W_{pi}-W_{pj})|}{\alpha_1+\alpha_2}\\
& \leq \frac{||\bmx_p^T(\bm{x}_i - \bm{x}_j)||_2 + ||\bmx_p^TYX^T(\bmx_i-\bmx_j)||_2}{\alpha_1+\alpha_2}\\
& + \frac{\alpha_2||\bmx_p^TY(\bm{w}_i - \bm{w}_j)||_2 + \alpha_2 |W_{pi}-W_{pj}|}{\alpha_1+\alpha_2}\\
\end{split}
\end{equation}
If $x_i \rightarrow x_j$, i.e., $\bmx_i^T\bmx_j \rightarrow 1$ and $||\bm{w}_i - \bm{w}_j||_2 \rightarrow 0$, 
we have
$||\bm{x}_i - \bm{x}_j||_2 \rightarrow 0$ and $|W_{pi}-W_{pj}| \rightarrow 0$.
Then $|Z_{pi}^*-Z_{pj}^*| \rightarrow 0$ and
$(Z^*)^T$ has grouping effect.
Since $\bigl||Z_{pi}^*|-|Z_{pj}^*|\bigr| \leq |Z_{pi}^*-Z_{pj}^*|$, $|(Z^*)^T|$ also has grouping effect.
\end{proof}
\end{lemma}

\begin{lemma}
\label{lemma4}
Matrix $\tilde{Z}$ has grouping effect. 
\begin{proof}
From Lemma~\ref{lemma:z-star} and~\ref{lemma3},
both $\lvert Z^*\rvert$ and $\lvert (Z^*)^T\rvert$ have the grouping effect.
Since $\tilde{Z} = (|Z^*|+|(Z^*)^T|)/2$,
\begin{equation}
\begin{split}
\lvert \tilde{Z}_{ip} - \tilde{Z}_{jp}\rvert & = \frac{\bigl| (|Z^*_{ip}|+|Z^*_{pi}|) - (|Z^*_{jp}|+|Z^*_{pj}|)\bigr|}{2} \\
& \leq \frac{|Z_{ip}^*-Z_{jp}^*| + |Z_{pi}^*-Z_{pj}^*|}{2}
\end{split}
\end{equation}
If $x_i \rightarrow x_j$,
both $|Z_{ip}^*-Z_{jp}^*| \rightarrow 0$ and $|Z_{pi}^*-Z_{pj}^*| \rightarrow 0$,
so $\lvert \tilde{Z}_{ip} - \tilde{Z}_{jp}\rvert \rightarrow 0$ and
$\tilde{Z}$ has grouping effect.
\end{proof}
\end{lemma}



